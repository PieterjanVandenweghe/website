{"version":3,"sources":["plugins.js"],"names":["TRANSLATIONS","INSTALL_OLD","INSTALL_CURRENT","LICENSE","HOMEPAGE","KEYWORDS","INSTALL","FILTER_PLACEHOLDER","FILTER_ANY_VERSION","FILTER_VERSION_LABEL","NO_MATCHES","DEPENDENCIES","VERSIONS","VERSION_NOT_FOUND","NOT_FOUND","FOUND","t","name","arguments","length","slice","reduce","acc","curr","replace","REPOSITORY_URL","plugins","init","json","Object","values","filter","plugin","forEach","alias","version","buf","description","keywords","join","search","toLocaleLowerCase","window","onpopstate","event","show","location","hash","content","substr","split","pluginVersions","sort","compareVersion","details","notFound","list","wrapper","document","getElementById","clear","append","doFilter","elem","addEventListener","fetch","then","response","catch","err","console","error","query","freetext","queryHandler","target","value","trim","versionHandler","count","querySelectorAll","li","match","id","style","display","empty","querySelector","hits","appendChild","createTextNode","clearFilter","platform","deps","find","dep","matchVersion","req","clearFilterHandler","keyCode","filterForm","input","type","class","placeholder","size","undefined","oninput","onkeypress","options","map","atts","selected","concat","onchange","a","b","localeCompare","first","href","flatMap","keyword","versions","vers","div","createElement","license","homepage","getDomain","url","humanReadableVersion","spdx","startsWith","attrs","installBlock","keys","key","setAttribute","parent","Array","isArray","c","myNode","firstChild","removeChild","parse","op","tokens","v","Number","parseInt","i","push","compare","zip","as","bs","e","verify","pair","pairs","reduced"],"mappings":"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","file":"plugins.map","sourceRoot":"../_js","sourcesContent":["const TRANSLATIONS = {\n  INSTALL_OLD: 'DITA-OT 3.1 and older',\n  INSTALL_CURRENT: 'DITA-OT 3.2 and newer',\n  LICENSE: 'License',\n  HOMEPAGE: 'Homepage',\n  KEYWORDS: 'Keywords',\n  INSTALL: 'Install',\n  FILTER_PLACEHOLDER: 'Filter plugins',\n  FILTER_ANY_VERSION: 'Any version',\n  FILTER_VERSION_LABEL: 'DITA-OT version',\n  NO_MATCHES: 'No matches found.',\n  DEPENDENCIES: 'Dependencies',\n  VERSIONS: 'Versions',\n  VERSION_NOT_FOUND: 'Plugin {} version {} not found.',\n  NOT_FOUND: 'Plugin {} not found.',\n  FOUND: 'Found {} matches.'\n}\n\nfunction t(name) {\n  if (arguments.length > 1) {\n    return [...arguments]\n      .slice(1)\n      .reduce((acc, curr) => acc.replace('{}', curr), TRANSLATIONS[name])\n  } else {\n    return TRANSLATIONS[name]\n  }\n}\n\nconst REPOSITORY_URL = 'https://plugins.dita-ot.org/_all.json'\nconst VERSIONS = [\n  '3.2',\n  // '3.1.3',\n  // '3.1.2',\n  // '3.1.1',\n  '3.1',\n  // '3.0.4',\n  // '3.0.3',\n  // '3.0.2',\n  // '3.0.1',\n  '3.0',\n  // '2.5.4',\n  // '2.5.3',\n  // '2.5.2',\n  // '2.5.1',\n  '2.5',\n  // '2.4.6',\n  // '2.4.5',\n  // '2.4.4',\n  // '2.4.3',\n  // '2.4.2',\n  // '2.4.1',\n  '2.4',\n  // '2.3.3',\n  // '2.3.2',\n  // '2.3.1',\n  '2.3',\n  // '2.2.5',\n  // '2.2.4',\n  // '2.2.3',\n  // '2.2.2',\n  // '2.2.1',\n  '2.2',\n  // '2.1.2',\n  // '2.1.1',\n  '2.1',\n  // '2.0.1',\n  '2.0',\n  // '1.8.5',\n  // '1.8.4',\n  // '1.8.3',\n  // '1.8.2',\n  // '1.8.1',\n  '1.8'\n  // '1.7.5',\n  // '1.7.4',\n  // '1.7.3',\n  // '1.7.2',\n  // '1.7.1'\n]\n\nlet plugins = null\n\ndocument.addEventListener('DOMContentLoaded', event => {\n  fetch(REPOSITORY_URL)\n    .then(response => response.json())\n    .then(init)\n    .catch(err => {\n      console.error('Failed to fetch plugins: ' + err)\n    })\n})\n\nfunction init(json) {\n  plugins = json\n  Object.values(plugins)\n    .filter(plugin => !!plugin)\n    .forEach(plugin => {\n      if (plugin.alias) {\n        // skip\n      } else {\n        plugin.forEach(version => {\n          const buf =\n            version.name +\n            ' ' +\n            (version.description && version.description) +\n            ' ' +\n            (version.keywords && version.keywords.join(' '))\n          version.search = buf\n            .toLocaleLowerCase()\n            .replace(/\\W/g, ' ')\n            .replace(/\\s+/g, ' ')\n        })\n      }\n    })\n  window.onpopstate = event => {\n    show(location.hash)\n  }\n  show(location.hash)\n}\n\nfunction show(hash) {\n  let content = null\n  if (!!hash) {\n    const [name, version] = hash.substr(1).split('/')\n    const pluginVersions = plugins[name].slice()\n    pluginVersions.sort(compareVersion)\n    content = details(pluginVersions, version) || notFound(name, version)\n  } else {\n    content = list(plugins)\n  }\n  const wrapper = document.getElementById('plugins')\n  clear(wrapper)\n  append(wrapper, content)\n  if (!hash) {\n    doFilter()\n  }\n}\n\nfunction notFound(name, version) {\n  return elem(\n    'p',\n    !!version\n      ? t('VERSION_NOT_FOUND', name, version) //`Plugin ${name} version ${version} not found.`\n      : t('NOT_FOUND', name) //`Plugin ${name} not found.`\n  )\n}\n\nconst query = {\n  freetext: null,\n  version: null\n}\n\nfunction queryHandler(event) {\n  query.freetext = event.target.value\n    .toLocaleLowerCase()\n    .replace(/\\W/g, ' ')\n    .replace(/\\s+/g, ' ')\n    .trim()\n  doFilter()\n}\n\nfunction versionHandler(event) {\n  query.version = event.target.value\n  doFilter()\n}\n\nfunction doFilter() {\n  if (!!query.freetext || !!query.version) {\n    let count = 0\n    document.querySelectorAll('#list > li').forEach(li => {\n      const plugin = plugins[li.id]\n      if (match(plugin[0])) {\n        count++\n        li.style.display = 'list-item'\n      } else {\n        li.style.display = 'none'\n      }\n    })\n    const empty = document.querySelector('#empty')\n    const hits = document.querySelector('#hits')\n    if (count === 0) {\n      empty.style.display = 'block'\n      hits.style.display = 'none'\n      clear(hits)\n    } else {\n      empty.style.display = 'none'\n      hits.style.display = 'block'\n      clear(hits)\n      hits.appendChild(document.createTextNode(t('FOUND', count)))\n    }\n  } else {\n    clearFilter()\n  }\n}\n\nfunction match(plugin) {\n  let freetext = !query.freetext\n  if (!!query.freetext && !!plugin.search.match(query.freetext)) {\n    freetext = true\n  }\n  let version = !query.version\n  const platform = plugin.deps.find(dep => dep.name === 'org.dita.base')\n  if (!!query.version && !!platform && matchVersion(query.version, platform.req)) {\n    version = true\n  }\n  return freetext && version\n}\n\nfunction clearFilter() {\n  document.querySelectorAll('#list > li').forEach(li => {\n    li.style.display = 'list-item'\n  })\n  const hits = document.querySelector('#hits')\n  hits.style.display = 'none'\n  // clear(hits)\n}\n\nfunction clearFilterHandler(event) {\n  if (event.keyCode === 27) {\n    // clearFilter()\n    document.querySelector('#query').value = ''\n    query.freetext = ''\n    // document.querySelector('#empty, #hits').style.display = 'none'\n    doFilter()\n  }\n}\n\nfunction filterForm() {\n  const input = elem(\n    'input',\n    {\n      id: 'query',\n      value: query.freetext || '',\n      type: 'text',\n      class: 'form-control',\n      placeholder: t('FILTER_PLACEHOLDER'),\n      size: 50\n    },\n    undefined\n  )\n  input.oninput = queryHandler\n  input.onkeypress = clearFilterHandler\n\n  const options = VERSIONS.map(version => {\n    const atts = { value: version }\n    if (version === query.version) {\n      atts.selected = 'selected'\n    }\n    return elem('option', atts, version)\n  })\n  const version = elem(\n    'select',\n    { id: 'version', class: 'form-control' },\n    [elem('option', { value: '' }, t('FILTER_ANY_VERSION'))].concat(options)\n  )\n  version.onchange = versionHandler\n\n  return elem('div', { class: 'form-inline' }, [\n    elem('div', { class: 'form-group' }, input),\n    ' ',\n    elem('div', { class: 'form-group' }, version)\n  ])\n}\n\nfunction list(json) {\n  return [\n    filterForm(),\n    elem(\n      'p',\n      { id: 'empty', style: 'display: none; margin-top: 1em', class: 'alert alert-info' },\n      t('NO_MATCHES')\n    ),\n    elem('p', { id: 'hits', style: 'display: none; margin-top: 1em' }, ''),\n    elem(\n      'ul',\n      { class: 'list-unstyled', id: 'list' },\n      Object.values(json)\n        .filter(plugin => !!plugin && !plugin.alias)\n        .sort((a, b) => a[0].name.localeCompare(b[0].name))\n        .map(plugin => plugin[0])\n        .map(first =>\n          elem('li', { id: first.name }, [\n            elem('h3', elem('a', { href: `#${first.name}` }, first.name)),\n            elem('p', first.description),\n            elem(\n              'p',\n              (first.keywords || []).flatMap(keyword => [\n                elem('code', { class: 'small' }, keyword),\n                ' \\u00A0'\n              ])\n            )\n          ])\n        )\n    )\n  ]\n}\n\nfunction details(versions, version) {\n  const first = !!version ? versions.find(plugin => plugin.vers === version) : versions[0]\n  if (!first) {\n    return null\n  }\n\n  const div = document.createElement('div')\n\n  div.appendChild(elem('h2', [`${first.name}`, elem('small', ` ${first.vers}`)]))\n\n  if (!!first.description) {\n    append(div, elem('p', { class: 'shortdesc' }, first.description))\n  }\n  if (!!first.keywords && first.keywords.length !== 0) {\n    append(div, [\n      elem('h3', t('KEYWORDS')),\n      elem('p', first.keywords.flatMap(keyword => [elem('code', keyword), ' \\u00A0']))\n    ])\n  }\n  if (!!first.license) {\n    append(div, [elem('h3', t('LICENSE')), elem('p', license(first.license))])\n  }\n  if (!!first.homepage) {\n    append(div, [\n      elem('h3', t('HOMEPAGE')),\n      elem('p', elem('a', { href: first.homepage }, getDomain(first.homepage)))\n    ])\n  }\n  append(div, [\n    elem('h3', t('INSTALL')),\n    elem('p', { class: 'small' }, t('INSTALL_CURRENT')),\n    elem('pre', `dita --install ${first.name}`),\n    elem('p', { class: 'small' }, t('INSTALL_OLD')),\n    elem('pre', `dita --install ${first.url}`)\n  ])\n\n  const deps = first.deps\n  deps.sort((a, b) => a.name.localeCompare(b.name))\n  append(div, [\n    elem('h3', t('DEPENDENCIES')),\n    elem(\n      'ul',\n      deps\n        .filter(dep => dep.name === 'org.dita.base')\n        .map(dep => elem('li', `DITA-OT ${humanReadableVersion(dep.req) || ''}`))\n    ),\n    elem(\n      'ul',\n      deps\n        .filter(dep => dep.name !== 'org.dita.base')\n        .map(dep => elem('li', `${dep.name} ${humanReadableVersion(dep.req) || ''}`))\n    )\n  ])\n\n  append(div, [\n    elem('h3', t('VERSIONS')),\n    elem(\n      'ul',\n      versions.map(version =>\n        elem('li', elem('a', { href: `#${first.name}/${version.vers}` }, version.vers))\n      )\n    )\n  ])\n\n  return div\n}\n\nfunction license(spdx) {\n  switch (spdx) {\n    case 'Apache-2.0':\n      return elem(\n        'a',\n        { href: 'https://www.apache.org/licenses/LICENSE-2.0' },\n        'Apache License 2.0'\n      )\n    case 'MIT':\n      return elem('a', { href: 'https://opensource.org/licenses/MIT' }, 'MIT License')\n    case 'UNLICENSED':\n      return 'Unlicensed'\n    default:\n      return spdx\n  }\n}\n\nfunction humanReadableVersion(version) {\n  if (version.startsWith('=')) {\n    return `${version.substr(1)}`\n  } else if (version.startsWith('>=')) {\n    return `${version.substr(2)} or newer`\n  } else if (version.startsWith('<=')) {\n    return `${version.substr(2)} or older`\n  }\n  return version\n}\n\nfunction getDomain(homepage) {\n  return homepage.replace(/^\\w+:\\/\\/([^\\/]+?)(\\/.*)?$/, '$1')\n}\n\n// DOM utils\n\nfunction elem() {\n  const name = arguments[0]\n  const attrs = arguments.length === 3 ? arguments[1] : {}\n  const content = arguments.length === 3 ? arguments[2] : arguments[1]\n  const installBlock = document.createElement(name)\n  Object.keys(attrs).forEach(key => {\n    installBlock.setAttribute(key, attrs[key])\n  })\n  append(installBlock, content)\n  return installBlock\n}\n\nfunction append(parent, content) {\n  if (content === undefined || content === null) {\n    return\n  }\n  switch (typeof content) {\n    case 'string':\n      parent.appendChild(document.createTextNode(content))\n      break\n    case 'object':\n      if (Array.isArray(content)) {\n        content.forEach(c => {\n          append(parent, c)\n        })\n        break\n      }\n    default:\n      parent.appendChild(content)\n  }\n}\n\nfunction clear(myNode) {\n  while (myNode.firstChild) {\n    myNode.removeChild(myNode.firstChild)\n  }\n}\n\n// Compare\n\nfunction parse(value) {\n  const op = value.replace(/\\./g, '').replace(/[^=<>.]/g, '')\n  const v = value.replace(/[=<>]/g, '')\n  const tokens = v.split('.').map(v => Number.parseInt(v))\n  if (tokens.length < 3) {\n    for (let i = tokens.length; i < 3; i++) {\n      tokens.push(0)\n    }\n  }\n  return {\n    op: !!op ? op : null,\n    tokens: tokens\n  }\n}\nfunction compare(a = 0, b = 0) {\n  if (a === b) {\n    return 0\n  } else if (a < b) {\n    return 1\n  } else {\n    return -1\n  }\n}\nfunction zip(as, bs) {\n  return as.map(function(e, i) {\n    return [e, bs[i]]\n  })\n}\n\nfunction compareVersion(a, b) {\n  try {\n    const as = parse(a)\n    const bs = parse(b)\n    const comparedPairs = zip(as.tokens, bs.tokens).map(pair => compare(pair[0], pair[1]))\n    return verify(comparedPairs)\n  } catch (e) {\n    return 0\n  }\n}\n\nfunction verify(pairs, op) {\n  const reduced = pairs.reduce((acc, curr) => (acc !== 0 ? acc : curr), 0)\n  if (op === '>=') {\n    return reduced <= 0\n  } else if (op === '>') {\n    return reduced < 0\n  } else if (op === '<=') {\n    return reduced >= 0\n  } else if (op === '<') {\n    return reduced > 0\n  } else {\n    return reduced === 0\n  }\n}\n\nfunction matchVersion(a, b) {\n  try {\n    const as = parse(a)\n    const bs = parse(b)\n    const comparedPairs = zip(as.tokens, bs.tokens).map(pair => compare(pair[0], pair[1]))\n    return verify(comparedPairs, bs.op)\n  } catch (e) {\n    return false\n  }\n}\n"]}