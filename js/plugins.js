'use strict';var plugins=null;document.addEventListener('DOMContentLoaded',function(event){fetch('https://plugins.dita-ot.org/_all.json').then(function(response){return response.json();}).then(init).catch(function(err){console.error('Failed to fetch plugins: '+err);});});function init(json){plugins=json;window.onpopstate=function(event){show(location.hash);};show(location.hash);}function show(hash){if(!!hash){var plugin=plugins[hash.substr(1)];details(plugin);}else{list(plugins);}}function list(json){var ul=document.createElement('ul');Object.values(json).filter(function(plugin){return!!plugin;}).sort(function(a,b){return a[0].name.localeCompare(b[0].name);}).forEach(function(plugin){var first=plugin[0];var li=document.createElement('li');var a=document.createElement('a');a.setAttribute('href','#'+first.name);a.setAttribute('style','font-weight:bold');a.appendChild(document.createTextNode(first.name));li.appendChild(a);var desc=document.createElement('p');desc.setAttribute('class','small');desc.appendChild(document.createTextNode(first.description));li.appendChild(desc);ul.appendChild(li);});var wrapper=document.getElementById('plugins');clear(wrapper);wrapper.appendChild(ul);}function details(versions){var first=versions[0];var div=document.createElement('div');var h2=document.createElement('h2');h2.appendChild(document.createTextNode(first.name));div.appendChild(h2);if(!!first.description){var desc=document.createElement('p');desc.appendChild(document.createTextNode(first.description));div.appendChild(desc);}if(!!first.keywords&&first.keywords.length!==0){var keywordTitle=document.createElement('h3');keywordTitle.appendChild(document.createTextNode('Keywords'));div.appendChild(keywordTitle);var _desc=document.createElement('p');_desc.appendChild(document.createTextNode(first.keywords.join(', ')));div.appendChild(_desc);}if(!!first.homepage){var title=document.createElement('h3');title.appendChild(document.createTextNode('Homepage'));div.appendChild(title);var _desc2=document.createElement('p');var link=document.createElement('a');link.setAttribute('href',first.homepage);link.appendChild(document.createTextNode(getDomain(first.homepage)));_desc2.appendChild(link);div.appendChild(_desc2);}var installTitle=document.createElement('h3');installTitle.appendChild(document.createTextNode('Install'));div.appendChild(installTitle);var installBlock=document.createElement('pre');installBlock.appendChild(document.createTextNode('dita --install '+first.name));div.appendChild(installBlock);var versionTitle=document.createElement('h3');versionTitle.appendChild(document.createTextNode('Versions'));div.appendChild(versionTitle);var versionWrapper=document.createElement('ul');versions.forEach(function(version){var li=document.createElement('li');li.appendChild(document.createTextNode(version.vers));versionWrapper.appendChild(li);});div.appendChild(versionWrapper);var wrapper=document.getElementById('plugins');clear(wrapper);wrapper.appendChild(div);}function getDomain(homepage){return homepage.replace(/^\w+:\/\/([^\/]+?)(\/.*)?$/,'$1');}function clear(myNode){while(myNode.firstChild){myNode.removeChild(myNode.firstChild);}}